<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="dark light" />

    <title>ViewerFrenzy ‚Äì Streamer Users</title>
    <meta name="description" content="ViewerFrenzy ‚Äì Streamer user list." />

    <link rel="stylesheet" href="/styles/app.css" />

    <script src="/config.js" defer></script>
    <script type="module" src="/js/page-common.js" defer></script>
    <script type="module" src="/js/streamer-users-page.js" defer></script>
  </head>

  <body data-page="streamer">
    <header class="vf-topbar">
      <button id="vf-menuBtn" class="vf-iconBtn" aria-label="Open menu" title="Menu" type="button">
        <span aria-hidden="true">‚ò∞</span>
      </button>

      <div class="vf-topbarTitle" role="heading" aria-level="1">
        <a href="/mainmenu.html" class="vf-link" style="color: inherit; text-decoration: none;">ViewerFrenzy</a>
      </div>

      <div class="vf-userChip" id="vf-userChip" hidden>
        <img id="vf-userAvatar" class="vf-userAvatar" alt="" />
        <div class="vf-userName" id="vf-userName">...</div>
      </div>
    </header>

    <aside id="vf-sidenav" class="vf-sidenav" aria-hidden="true">
      <div class="vf-sidenavHeader">
        <div class="vf-brandSmall">
          <div class="vf-brandMarkSmall" aria-hidden="true">VF</div>
          <div>
            <div class="vf-sidenavTitle">Menu</div>
            <div class="vf-sidenavSub" id="vf-sidenavSub">Not signed in</div>
          </div>
        </div>
        <button id="vf-closeMenuBtn" class="vf-iconBtn" aria-label="Close menu" title="Close" type="button">
          <span aria-hidden="true">‚úï</span>
        </button>
      </div>

      <nav class="vf-nav">
        <a class="vf-navItem" href="/mainmenu.html" data-route="home">
          <span class="vf-navIcon" aria-hidden="true">üè†</span>
          <span>Home</span>
        </a>

        <a class="vf-navItem" href="/garage.html" data-route="garage">
          <span class="vf-navIcon" aria-hidden="true">üõ†Ô∏è</span>
          <span>Garage</span>
        </a>

        <a class="vf-navItem" href="/stats.html" data-route="stats">
          <span class="vf-navIcon" aria-hidden="true">üèÜ</span>
          <span>Stats</span>
        </a>

        <a class="vf-navItem" href="/streamer.html" data-route="streamer" data-requires="streamer" hidden>
          <span class="vf-navIcon" aria-hidden="true">üé•</span>
          <span>Streamer</span>
        </a>

        <a class="vf-navItem" href="/achievements.html" data-route="achievements">
          <span class="vf-navIcon" aria-hidden="true">üéñÔ∏è</span>
          <span>Achievements</span>
        </a>

        <a class="vf-navItem" href="/charactercreator.html" data-route="character">
          <span class="vf-navIcon" aria-hidden="true">üßë‚Äçüé®</span>
          <span>Character Creator</span>
          <span class="vf-pill">Soon</span>
        </a>

        <a class="vf-navItem" href="/logout.html" data-route="logout">
          <span class="vf-navIcon" aria-hidden="true">üö™</span>
          <span>Logout</span>
        </a>
      </nav>

      <div class="vf-sidenavFooter">
        <div class="vf-small vf-muted">
          API healthcheck:
          <a class="vf-link" href="/healthcheck" target="_blank" rel="noopener">/healthcheck</a>
        </div>
      </div>
    </aside>

    <div id="vf-backdrop" class="vf-backdrop" hidden></div>

    <main id="vf-main" class="vf-main" tabindex="-1">
      <div class="vf-container">
        <h1 class="vf-h1">Streamer Users</h1>

        <div class="vf-card" style="margin-top: 12px">
          <div class="vf-muted" style="margin-bottom: 10px">
            These are viewers who have joined your competitions.
          </div>

          <div class="vf-controlsGrid" style="margin-bottom: 10px">
            <div class="vf-field" style="min-width: min(420px, 100%)">
              <div class="vf-fieldLabel">Add user (Twitch login or numeric user id)</div>
              <input id="vf-addUserInput" class="vf-input" type="text" placeholder="example: someviewer" autocomplete="off" />
            </div>

            <button id="vf-addUserBtn" class="vf-btn" type="button">Add</button>
            <button id="vf-refreshBtn" class="vf-btn" type="button">Refresh</button>
          </div>

          <div id="vf-addUserMsg" class="vf-alert" hidden></div>
        </div>

        <div class="vf-splitGrid" style="margin-top: 12px">
          <div class="vf-card">
            <div class="vf-row" style="justify-content: space-between; align-items: flex-end; gap: 10px; flex-wrap: wrap">
              <div>
                <div class="vf-h2" style="margin: 0">Users</div>
                <div class="vf-small vf-muted" id="vf-userCount">Loading‚Ä¶</div>
              </div>

              <div class="vf-row" style="gap: 8px; align-items: flex-end; justify-content: flex-end">
                <div class="vf-field" style="min-width: min(260px, 100%); margin: 0">
                  <div class="vf-fieldLabel">Twitch role filter</div>
                  <select id="vf-roleFilter" class="vf-select">
                    <option value="all">All Roles</option>
                  </select>
                </div>

                <button id="vf-syncRolesBtn" class="vf-btn vf-btnSecondary" type="button" disabled>Sync</button>
              </div>
            </div>

            <div id="vf-roleMsg" class="vf-alert" hidden></div>

            <div class="vf-tableWrap" style="margin-top: 10px">
              <table class="vf-table vf-tableAuto">
                <thead>
                  <tr>
                    <th>Display Name</th>
                    <th>Login</th>
                    <th>User ID</th>
                    <th>First Joined</th>
                    <th>Last Joined</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="vf-usersTbody">
                  <tr><td colspan="6" class="vf-muted">Loading‚Ä¶</td></tr>
                </tbody>
              </table>
            </div>

            <div class="vf-small vf-muted" style="margin-top: 10px">
              Removing a user here only removes them from <b>your</b> streamer list. It does not delete the global user record.
            </div>
          </div>

          <div class="vf-card" id="vf-userDetailsCard">
            <div class="vf-row" style="justify-content: space-between; align-items: flex-end; gap: 10px; flex-wrap: wrap">
              <div>
                <div class="vf-h2" style="margin: 0">Selected User</div>
                <div class="vf-small vf-muted" id="vf-selectedUserSub">Select a user from the list to edit ViewerFrenzy roles.</div>
              </div>

              <button id="vf-clearSelectionBtn" class="vf-btn vf-btnSecondary" type="button" hidden>Clear</button>
            </div>

            <div id="vf-userRolesMsg" class="vf-alert" style="margin-top: 10px" hidden></div>

            <div id="vf-selectedUserEmpty" class="vf-muted" style="margin-top: 12px">
              Tip: You can create custom roles on the <a class="vf-link" href="/streamer-user-roles.html">User Roles</a> page.
            </div>

            <div id="vf-selectedUserBody" hidden>
              <div class="vf-row" style="gap: 12px; align-items: center; margin-top: 12px">
                <img id="vf-selectedUserAvatar" class="vf-userAvatar" alt="" style="width: 44px; height: 44px" />
                <div>
                  <div id="vf-selectedUserName" style="font-weight: 900">‚Äî</div>
                  <div class="vf-small vf-muted" id="vf-selectedUserLogin">‚Äî</div>
                </div>
              </div>

              <div class="vf-small" style="margin-top: 12px">
                <div><span class="vf-muted">User ID:</span> <span id="vf-selectedUserId">‚Äî</span></div>
                <div><span class="vf-muted">First Joined:</span> <span id="vf-selectedUserFirst">‚Äî</span></div>
                <div><span class="vf-muted">Last Joined:</span> <span id="vf-selectedUserLast">‚Äî</span></div>
              </div>

              <div style="margin-top: 14px">
                <div class="vf-fieldLabel">ViewerFrenzy Roles (custom)</div>
                <div class="vf-small vf-muted" style="margin-top: 4px">
                  A viewer can be in multiple roles. These roles are unique to your stream.
                </div>

                <div id="vf-vfRolesWrap" style="margin-top: 10px"></div>
                <div id="vf-noVfRolesNote" class="vf-small vf-muted" style="margin-top: 8px" hidden>
                  No custom roles yet. Create roles on the <a class="vf-link" href="/streamer-user-roles.html">User Roles</a> page.
                </div>

                <button id="vf-saveUserRolesBtn" class="vf-btn" type="button" style="margin-top: 10px" disabled>
                  Save Roles
                </button>
              </div>

              <div style="margin-top: 14px">
                <div class="vf-fieldLabel">Twitch Roles (synced)</div>
                <div id="vf-twitchRolesChips" class="vf-chipRow" style="margin-top: 8px"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <div id="vf-toast" class="vf-toast" hidden></div>
  </body>
</html>
